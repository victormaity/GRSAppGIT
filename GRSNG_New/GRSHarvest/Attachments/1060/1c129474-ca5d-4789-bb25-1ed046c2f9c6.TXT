          SELECT * FROM (SELECT DISTINCT dcpa.deal_id FROM (SELECT deal_id, CASE WHEN co.company_name IS NULL THEN 'Undisclosed' ELSE co.company_name END AS dealcompanyprincipal FROM LS_SRV.jp_deal dl LEFT JOIN LS_SRV.jp_deal_type dt ON (dt.deal_type_id = dl.deal_type_id) LEFT JOIN LS_SRV.jp_deal_status ds ON (ds.status_code = dl.status_code) LEFT JOIN LS_SRV.jp_company co ON (dl.principal_company_id = co.company_id) ) dcpr, (SELECT deal_id, CASE WHEN co.company_name IS NULL THEN 'Undisclosed' ELSE co.company_name END AS dealcompanypartner FROM LS_SRV.jp_deal dl LEFT JOIN LS_SRV.jp_company co ON (dl.partnering_company_id = co.company_id) ) dcpa, (SELECT deal_id FROM LS_SRV.jp_deal_indication di JOIN LS_SRV.jp_indication i ON (i.indication_id = di.indication_id) ) di, (SELECT deal_id FROM LS_SRV.jp_deal_action da JOIN LS_SRV.ng_action_primary ap ON (da.action_id   = ap.action_id) WHERE action_name IS NOT NULL ) da, (SELECT deal_id FROM LS_SRV.jp_deal_action da JOIN LS_SRV.ng_action_secondary ap ON (da.action_id = ap.action_id) GROUP BY da.deal_id ) das, (SELECT deal_id FROM LS_SRV.jp_deal_technology dt JOIN LS_SRV.jp_technology tec ON (tec.technology_id    = dt.technology_code) WHERE dt.deal_id IS NOT NULL AND tec.technology_name IS NOT NULL ) dt, (SELECT deal_id FROM LS_SRV.jp_drug_deal dl JOIN LS_SRV.jp_drug dr ON (dr.drug_id = dl.drug_id) JOIN LS_SRV.jp_drug_name dn ON (dn.drug_name_id = dr.display_name_id) ) dd, (SELECT de.deal_id FROM LS_SRV.ng_deal_id_investigational ngd JOIN (SELECT DISTINCT de.deal_id, co.country_name, co.country_id FROM LS_SRV.jp_deal_event de JOIN LS_SRV.jp_deal_event_country decc ON (de.event_id = decc.event_id) JOIN (SELECT deal_id, MAX(event_date) AS maxdate FROM LS_SRV.jp_deal_event GROUP BY deal_id ) ded ON (ded.deal_id = de.deal_id) JOIN LS_SRV.jp_country co ON (co.country_id   = decc.country_id) WHERE decc.exclude  = 'N' AND de.event_date   = ded.maxdate )de ON (ngd.deal_id = de.deal_id) ) dti, (SELECT de.deal_id FROM LS_SRV.ng_deal_id_investigational ngd JOIN (SELECT DISTINCT de.deal_id, co.country_name, co.country_id FROM LS_SRV.jp_deal_event de JOIN LS_SRV.jp_deal_event_country decc ON (de.event_id = decc.event_id) JOIN (SELECT deal_id, MAX(event_date) AS maxdate  FROM LS_SRV.jp_deal_event GROUP BY deal_id ) ded ON (ded.deal_id = de.deal_id) JOIN LS_SRV.jp_country co ON (co.country_id   = decc.country_id) WHERE decc.exclude  = 'Y' AND de.event_date   = ded.maxdate )de ON (ngd.deal_id = de.deal_id) ) dte WHERE dcpr.deal_id = dcpa.deal_id AND dcpr.deal_id   =di.deal_id AND dcpr.deal_id   =da.deal_id AND dcpr.deal_id   =das.deal_id AND dcpr.deal_id   =dt.deal_id AND dcpr.deal_id   =dd.deal_id AND dcpr.deal_id   =dti.deal_id AND dcpr.deal_id   =dte.deal_id AND rownum<501 ORDER BY dbms_random.value ) WHERE rownum<2     